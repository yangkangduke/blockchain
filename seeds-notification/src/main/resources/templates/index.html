<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>websocket测试</title>
    <script src="https://cdn.bootcss.com/jquery/3.3.0/jquery.min.js"></script>
    <style type="text/css">
        h3, h4 {
            text-align: center;
        }
    </style>
</head>


<script crossorigin="anonymous" src="https://lib.baomitu.com/socket.io/2.3.0/socket.io.js"></script>

<script>

    $(function () {
        const IO = io.connect('http://127.0.0.1:8899', {
            'force new connection': true,
            'reconnection': true,
            'reconnectionDelay': 2000,                  // starts with 2 secs delay, then 4, 6, 8, until 60 where it stays forever until it reconnects
            'reconnectionDelayMax': 5000,               // 1 minute maximum delay between connections
            'reconnectionAttempts': 10,         // to prevent dead clients, having the user to having to manually reconnect after a server restart.
            'timeout': 10000,                           // before connect_error and connect_timeout are emitted.
            'transports': ['websocket', 'polling'],
            'query': {
                'token': '479d3e9f7dcba14f355671f6a3f0a7487d784de4',
                'userId': 10,
                'source': 0
            }
        })

        IO.on('connect', function (data) {
            console.log(data);
        })
        IO.on('disconnect', function (data) {
            console.log(data);
        })
        IO.on('new-notice', function (data) {
            console.log(data);
            $('#messageId').html(data);
        })
    })


</script>

<body>

<h3>WebSocket测试，客户端接收到的消息如下：</h3>

<textarea id="messageId" readonly="readonly" cols="150" rows="30">

</textarea>

</body>
</html>