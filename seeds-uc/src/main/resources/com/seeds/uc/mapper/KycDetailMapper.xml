<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.seeds.uc.mapper.KycDetailMapper">
    <resultMap id="BaseResultMap" type="com.seeds.uc.model.KycDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 25 20:06:57 CST 2020.
        -->
        <id column="f_id" jdbcType="BIGINT" property="id"/>
        <result column="f_uid" jdbcType="BIGINT" property="uid"/>
        <result column="f_country_code" jdbcType="VARCHAR" property="countryCode"/>
        <result column="f_first_name" jdbcType="VARCHAR" property="firstName"/>
        <result column="f_last_name" jdbcType="VARCHAR" property="lastName"/>
        <result column="f_identity" jdbcType="VARCHAR" property="identity"/>
        <!--        <result column="f_identity_file_uuid" jdbcType="VARCHAR" property="identityFileUuid"/>-->
        <result column="f_created_at" jdbcType="BIGINT" property="createdAt"/>
        <result column="f_updated_at" jdbcType="BIGINT" property="updatedAt"/>
        <result column="f_status" jdbcType="SMALLINT" property="status"/>
        <result column="f_comment" jdbcType="VARCHAR" property="comment"/>
        <result column="f_operator_id" jdbcType="BIGINT" property="operatorId"/>
        <result column="f_operator_name" jdbcType="VARCHAR" property="operatorName"/>
        <association property="file" javaType="com.seeds.uc.model.File">
            <id column="f_id" jdbcType="BIGINT" property="id"/>
            <result column="f_uid" jdbcType="BIGINT" property="uid"/>
            <result column="f_uuid" jdbcType="VARCHAR" property="uuid"/>
            <result column="f_filename" jdbcType="VARCHAR" property="filename"/>
            <result column="f_created_at" jdbcType="BIGINT" property="createdAt"/>
        </association>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 25 20:06:57 CST 2020.
        -->
        delete from t_uc_kyc_detail
        where f_id = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.seeds.uc.model.KycDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 25 20:06:57 CST 2020.
        -->
        insert into t_uc_kyc_detail (f_id, f_uid, f_country_code,
        f_first_name, f_last_name, f_identity,
        f_created_at, f_updated_at, f_status, f_comment,f_operator_id,f_operator_name,
        f_identity_file_uuid
        )
        values (#{id,jdbcType=BIGINT}, #{uid,jdbcType=BIGINT}, #{countryCode,jdbcType=VARCHAR},
        #{firstName,jdbcType=VARCHAR}, #{lastName,jdbcType=VARCHAR}, #{identity,jdbcType=VARCHAR},
        #{createdAt,jdbcType=BIGINT}, #{updatedAt,jdbcType=BIGINT},
        #{status,jdbcType=SMALLINT}, #{comment,jdbcType=VARCHAR},
        #{operatorId,jdbcType=BIGINT}, #{operatorName,jdbcType=VARCHAR},
        #{file.uuid,jdbcType=VARCHAR}
        )
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.seeds.uc.model.KycDetail">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 25 20:06:57 CST 2020.
        -->
        update t_uc_kyc_detail
        set f_uid = #{uid,jdbcType=BIGINT},
        f_country_code = #{countryCode,jdbcType=VARCHAR},
        f_first_name = #{firstName,jdbcType=VARCHAR},
        f_last_name = #{lastName,jdbcType=VARCHAR},
        f_identity = #{identity,jdbcType=VARCHAR},
        f_identity_file_uuid = #{identityFileUuid,jdbcType=VARCHAR},
        f_created_at = #{createdAt,jdbcType=BIGINT},
        f_updated_at = #{updatedAt,jdbcType=BIGINT},
        f_status = #{status,jdbcType=SMALLINT},
        f_comment = #{comment,jdbcType=VARCHAR}
        where f_id = #{id,jdbcType=BIGINT}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 25 20:06:57 CST 2020.
        -->
        select f_id, f_uid, f_country_code, f_first_name, f_last_name, f_identity, f_identity_file_uuid,
        f_created_at, f_updated_at, f_status, f_comment
        from t_uc_kyc_detail
        where f_id = #{id,jdbcType=BIGINT}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Tue Aug 25 20:06:57 CST 2020.
        -->
        select f_id, f_uid, f_country_code, f_first_name, f_last_name, f_identity, f_identity_file_uuid,
        f_created_at, f_updated_at, f_status, f_comment
        from t_uc_kyc_detail
    </select>
    <select id="selectByUid" resultMap="BaseResultMap">
        select f_id,
               f_uid,
               f_country_code,
               f_first_name,
               f_last_name,
               f_identity,
               f_identity_file_uuid,
               f_created_at,
               f_updated_at,
               f_status,
               f_comment
        from t_uc_kyc_detail
        where f_uid = #{uid}
        order by f_created_at desc;
    </select>

    <select id="countKycRecords" resultType="java.lang.Integer">
        select count(*) from t_uc_kyc_detail d INNER JOIN t_uc_file f on d.f_identity_file_uuid = f.f_uuid
        <if test="status!=0">
            where f.f_status = #{status}
        </if>
    </select>

    <select id="selectKycByPagination" resultMap="BaseResultMap">
        select * from t_uc_kyc_detail d INNER JOIN t_uc_file f on d.f_identity_file_uuid = f.f_uuid
        <if test="status!=0">
            where f.f_status = #{status}
        </if>
        order by d.f_id desc limit #{currentPage}, #{pageSize}
    </select>

    <update id="updateKycStatus" parameterType="com.seeds.uc.model.KycDetail">
        update t_uc_kyc_detail
        set f_updated_at    = #{updatedAt},
            f_status        = #{status},
            f_comment       = #{comment},
            f_operator_id   = #{operatorId},
            f_operator_name = #{operatorName}
        where f_id = #{id}
    </update>

    <select id="selectPassedKycDetailByUid" resultMap="BaseResultMap">
        select *
        from t_uc_kyc_detail
        where f_uid = #{uid}
          and f_status = 2
    </select>
</mapper>